---
- name: configure developer environment
  hosts: localhost
  become: yes
  connection: local
  vars:
    home: "{{ lookup('env','HOME') }}"
    user: "{{ lookup('env','USER') }}"
    githome: "{{ home }}/git/config_files"
  remote_user: '{{ user }}'

  tasks:
  - name: install config_file files
    file:
      src: '{{ githome }}/configs/{{ item.src }}'
      dest: '{{ home }}/{{ item.dest }}'
      state: link
      force: yes
      owner: '{{ user }}'
    with_items:
      - { src: 'gitconfig', dest: '.gitconfig' }
      - { src: 'gitconfig.prof', dest: '.gitconfig.prof' }
      - { src: 'muttrc', dest: '.muttrc' }
      - { src: 'tmux.conf', dest: '.tmux.conf' }
      - { src: 'vimrc', dest: '.vim/vimrc' }
      - { src: 'zshrc', dest: '.zshrc' }
      - { src: 'tmux_default.json', dest: '.config/powerline/themes/tmux/default.json' }
      - { src: 'vim_default.json', dest: '.config/powerline/themes/vim/default.json' }

  - name: create etc directories
    file:
      state: directory
      path: '/etc/{{ item }}'
      force: yes
    with_items:
      - sysctl.d
      - gdbinit.d

  - name: copy etc files
    copy:
      src: '{{ githome }}/configs/{{ item.src }}'
      dest: '/etc/{{ item.dest }}'
      force: yes
    with_items:
      - { src: 'kernel.conf', dest: 'sysctl.d/kernel.conf' }
      - { src: 'default.gdb', dest: 'gdbinit.d/default.gdb' }
